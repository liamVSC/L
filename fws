local plr = game.Players.LocalPlayer
local customModules = {}

customModules.bypassAntiCheat = function()
    plr.Character.Humanoid.WalkSpeed = 100
    local old; old = hookmetamethod(game, "__namecall", function(self, ...) 
        if self == plr and getnamecallmethod() == "Kick" and not checkcaller() then 
            plr.Character.Humanoid.WalkSpeed = 16
            return task.wait(99e99)
        end
        return old(self, ...)
    end)
end

coroutine.wrap(function() 
    pcall(function() 
        if getconnections then 
            repeat
                for i,v in pairs(getconnections(game:GetService("ScriptContext").Error)) do
                    v:Disable()
                end
                task.wait(5)
            until false == true
        end
    end)
end)()

customModules.bypassAntiCheat()

customModules.getZones = function()
    local worlds = {}
    for i,v in pairs(require(game:GetService("ReplicatedStorage").Game.Worlds)) do
        worlds[v.Order] = i
    end
    
    for i = 1,#worlds do
        local test = #worlds - i + 1
        worlds[i], worlds[test] = worlds[test], worlds[i]
    end
    return worlds
end

customModules.loadAllZones = function()
    for i,v in next, game:GetService("ReplicatedStorage").Chunks:children() do
        if v:FindFirstChild("Items") then
            v.Items.Parent = workspace.GameObjects.Areas[v.Name]
        end
    end
end

customModules.getZonesItems = function(zone)
    if not workspace.GameObjects.Areas[zone] then return warn("Invalid Zone") end
    if not workspace.GameObjects.Areas[zone].Items then return warn("No Items Loaded") end
    local items = {"All"}
    for i,v in pairs(game.Workspace.GameObjects.Areas[zone].Items:GetChildren()) do
        local name = v.Name:gsub('%d+','');
        if not table.find(items, name) then
            table.insert(items, name);
        end
    end
    print("here")
    return items
end

customModules.getEggs = function()
    local eggs = {}
    for i,v in next, workspace.GameObjects.Eggs:children() do
        table.insert(eggs,v.Name)
    end
    return eggs
end

customModules.getPetsFromEgg = function(egg)
    local pets = {}
    for i,v in next, require(game:GetService("ReplicatedStorage").Game.Eggs)[egg].Pets do
        table.insert(pets,i)
    end
    return pets
end

customModules.getHatsFromZone = function(zone)
    local hats = {}
    print(zone)
    for i,v in next, require(game:GetService("ReplicatedStorage").Game.Hats)[zone] do
        table.insert(hats,v.RealName)
    end
    return hats
end

customModules.getNearestItem = function(zone,select)
    if select == "All" or select == nil then select = "" end
    if not workspace.GameObjects.Areas[zone] then return end
    local item
    local nearestDist = math.huge;
    for i,v in next, workspace.GameObjects.Areas:FindFirstChild(zone).Items:GetChildren() do
        if not v.PrimaryPart then continue end
        local dist = (v.PrimaryPart.Position - plr.Character.HumanoidRootPart.Position).magnitude
        if dist < nearestDist and v.Name:match(select) then
            item = v; nearestDist = dist;
        end
    end
    return item
end

local zone
local itemSelected
local autoFarmBool
local network = require(game.ReplicatedStorage.Modules.Network)

customModules.autoFarm = function()
    task.spawn(function()
        customModules.bypassAntiCheat()
        repeat task.wait()
            if zone == nil then continue end
            if #workspace.GameObjects.Areas[zone].Items:GetChildren() == 0 then continue end
            local nearestItem = customModules.getNearestItem(zone,itemSelected)
            if nearestItem then
                plr.Character:PivotTo(nearestItem:GetPivot())
                network:FireServer("Hit",nearestItem)
            end
        until not autoFarmBool
    end)
end

local autoOrbsBool

customModules.autoOrbs = function()
    game.Workspace.Orbs.ChildAdded:connect(function(C)
        if autoOrbsBool then
            network:FireServer("CollectOrb", C.Name);
            C:Destroy()
        end
    end)
    task.spawn(function()
        while autoOrbsBool and task.wait() do
            for i,v in pairs(game.Workspace.Orbs:GetChildren()) do
                network:FireServer("CollectOrb", v.Name);
                v:Destroy();
            end
        end
    end)
end

local eggSelected
local amountToOpen = 1
local autoEggBool
local deleteList = {}

customModules.autoEgg = function()
    task.spawn(function()
        repeat task.wait(.5)
            network:InvokeServer("OpenEgg",eggSelected,amountToOpen,deleteList)
            print("hatching")
        until not autoEggBool
    end)
end

local deleteHatList = {}
local autoHatBool

customModules.autoHat = function()
    plr.PlayerGui.GameUI.Menus.Hats.MainList.ChildAdded:Connect(function(child)
        if autoHatBool then
            if deleteHatList[child.Frame.HatName.Text] then
                network:InvokeServer("DeleteHat",child.Name)
                child:Destroy()
            end
        end
    end)
end

local Mercury = loadstring(game:HttpGet("https://raw.githubusercontent.com/liamVSC/L/ui/mercury"))()
local GUI = Mercury:Create{
    Name = "Firework Simulator",
    --Size = UDim2.fromOffset(600, 400),
    Theme = Mercury.Themes.Rust,
    Link = "Firework Simulator"
}
local localTab = GUI:Tab{
	Name = "player",
	Icon = "rbxassetid://6023426915"
}
local Farming = GUI:Tab{
	Name = "automation",
	Icon = "rbxassetid://6023426921"
}
local pets = GUI:Tab{
    Name = "pets/eggs",
    Icon = "rbxassetid://6031260782"
}

GUI:set_status("ONLINE")

local itemDropdown
local hatDropdown

Farming:Dropdown{
	Name = "Zone Dropdown",
	StartingText = "Select:",
	Description = "Select the zone you want to farm",
	Items = customModules.getZones(),
	Callback = function(item)
        customModules.loadAllZones()
        zone = item
        itemDropdown:Clear()
        hatDropdown:Clear()
        task.wait(0.25)
        itemDropdown:AddItems(customModules.getZonesItems(item))
        hatDropdown:AddItems(customModules.getHatsFromZone(item))
    end
}

itemDropdown = Farming:Dropdown{
	Name = "Item Dropdown",
	StartingText = "Select:",
	Description = "Select the zone you want to farm",
	Items = {"Select an area to farm"},
	Callback = function(item)
        itemSelected = item
    end
}

Farming:Toggle{
	Name = "Auto Farm",
	StartingState = false,
	Description = nil,
	Callback = function(state)
        autoFarmBool = state
        customModules.autoFarm()
    end
}

Farming:Toggle{
	Name = "Auto Orbs",
	StartingState = false,
	Description = nil,
	Callback = function(state)
        autoOrbsBool = state
        customModules.autoOrbs()
    end
}

hatDropdown = Farming:Dropdown{
    Name = "Hats Dropdown",
	StartingText = "Select:",
	Description = "Select the hats you want to delete from farming",
	Items = {"Select an area to farm"},
	Callback = function(item)
        deleteHatList[tostring(item)] = true
        printtable(deleteHatList)
        hatDropdown:RemoveItems({item})
    end
}

Farming:Toggle{
	Name = "Auto Delete Hats",
	StartingState = false,
	Description = nil,
	Callback = function(state)
        autoHatBool = state
        customModules.autoHat()
    end
}

--EGGS/PETS

local petsDropdown

pets:Dropdown{
    Name = "Egg Dropdown",
	StartingText = "Select:",
	Description = "Select the egg you want to farm",
	Items = customModules.getEggs(),
	Callback = function(item)
        deleteList = {}
        petsDropdown:Clear()
        eggSelected = item
        task.wait(.25)
        petsDropdown:AddItems(customModules.getPetsFromEgg(item))
    end
}

petsDropdown = pets:Dropdown{
    Name = "Pets Dropdown",
	StartingText = "Select:",
	Description = "Select the pets you want to delete from egg opening",
	Items = {"Please Selecte a egg"},
	Callback = function(item)
        deleteList[tostring(item)] = true
        petsDropdown:RemoveItems({item})
        printtable(deleteList)
    end
}

pets:Slider{
	Name = "Amount to open",
	Default = 2,
	Min = 1,
	Max = 3,
	Callback = function(value)
        amountToOpen = value
    end
}

pets:Toggle{
    Name = "Auto Egg",
    StartingState = false,
	Description = nil,
	Callback = function(state)
        autoEggBool = state
        customModules.autoEgg()
    end
}

--LOCAL TAB
localTab:Slider{
	Name = "WalkSpeed",
	Default = 30,
	Min = 0,
	Max = 100,
	Callback = function(value)
        plr.Character.Humanoid.WalkSpeed = value
    end
}

localTab:Button{
    Name = "Open/Close Golden Pets",
    Description = nil,
	Callback = function() 
        plr.PlayerGui.GameUI.Menus.Golden.Visible = not plr.PlayerGui.GameUI.Menus.Golden.Visible
    end
}

localTab:Button{
    Name = "Open/Close Diamond Pets",
    Description = nil,
	Callback = function() 
        plr.PlayerGui.GameUI.Menus.Diamond.Visible = not plr.PlayerGui.GameUI.Menus.Diamond.Visible
    end
}

localTab:Button{
    Name = "Open/Close Rainbow Pets",
    Description = nil,
	Callback = function()
        plr.PlayerGui.GameUI.Menus.Rainbow.Visible = not plr.PlayerGui.GameUI.Menus.Rainbow.Visible
    end
}

localTab:Button{
    Name = "Open/Close Shiny Hats",
    Description = nil,
	Callback = function()
        plr.PlayerGui.GameUI.Menus.Shiny.Visible = not plr.PlayerGui.GameUI.Menus.Shiny.Visible
    end
}

GUI:Credit{
	Name = "liam",
	Description = "Script Creator",
	V3rm = "beAssed.com",
	Discord = "liam#3566"
}
